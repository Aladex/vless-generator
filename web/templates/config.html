<!DOCTYPE html>
<html lang="{{.Language}}">
<head>
    <title>{{.Texts.title}} - {{.ConfigType}}</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="stylesheet" href="/static/css/config.css">
</head>
<body>
    <!-- Floating Language Selector -->
    <div class="floating-language-selector" id="languageSelector">
        <button class="language-toggle" id="languageToggle" aria-label="Change language" aria-expanded="false" aria-controls="languageDropdown">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="globe-icon">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="2" y1="12" x2="22" y2="12"></line>
                <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
            </svg>
        </button>
        <div class="language-dropdown" id="languageDropdown" aria-hidden="true">
            <ul role="menu">
                <li role="menuitem">
                    <a href="#" data-lang="en" {{if eq .Language "en"}}class="active"{{end}}>English</a>
                </li>
                <li role="menuitem">
                    <a href="#" data-lang="ru" {{if eq .Language "ru"}}class="active"{{end}}>Русский</a>
                </li>
            </ul>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <div class="config-container">
            <!-- Left Column -->
            <div class="config-left">
                <div class="wizard-card wizard-main">
                    <div class="step-title">{{.Texts.your_vless_config}}</div>

                    <div class="result-section">
                        <p>{{.Texts.config_ready_desc}}</p>

                        <!-- UUID Display -->
                        <div class="form-group">
                            <label>UUID</label>
                            <div class="generated-link uuid-display">
                                {{.UUID}}
                            </div>
                        </div>

                        <!-- QR Code Section -->
                        <div class="qr-code-container">
                            <img src="data:image/png;base64,{{.QRCode}}"
                                alt="VLESS Configuration QR Code" />
                        </div>

                        <!-- VLESS URL Display -->
                        <div class="form-group">
                            <label>{{.Texts.ready_link}}</label>
                            <div class="generated-link" id="vlessUrl">{{.VlessURL}}</div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="action-buttons">
                            <button class="btn btn-success btn-large" onclick="copyVlessUrl()">
                                {{.Texts.copy_link}}
                            </button>
                            <a href="/config/{{.ConfigTypeOrig}}/{{.UUID}}.json{{if .QueryString}}?{{.QueryString}}{{end}}"
                            download class="btn btn-primary btn-large">
                                {{.Texts.download_json}}
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Instructions Tabs -->
                <div class="wizard-card steps-card">
                    <div class="tab-container">
                        <button class="tab-button active" data-tab="ios">iOS</button>
                        <button class="tab-button" data-tab="android">Android</button>
                        <button class="tab-button" data-tab="windows">Windows</button>
                    </div>

                    <div id="ios" class="tab-content active">
                        <h3>iOS Setup Instructions</h3>
                        <ol>
                            <li>Download and install a VLESS compatible client.</li>
                            <li>Scan the QR code above or copy the VLESS URL.</li>
                            <li>Import the configuration and connect to start using VPN.</li>
                        </ol>
                    </div>

                    <div id="android" class="tab-content">
                        <h3>Android Setup Instructions</h3>
                        <ol>
                            <li>Download and install a VLESS compatible client.</li>
                            <li>Scan the QR code above or copy the VLESS URL.</li>
                            <li>Import the configuration and connect to start using VPN.</li>
                        </ol>
                    </div>

                    <div id="windows" class="tab-content">
                        <h3>Windows Setup Instructions</h3>
                        <ol>
                            <li>Download and install a VLESS compatible client.</li>
                            <li>Scan the QR code above or copy the VLESS URL.</li>
                            <li>Import the configuration and connect to start using VPN.</li>
                        </ol>
                    </div>
                </div>
            </div>

            <!-- Right Column -->
            <div class="config-right">
                <div class="config-params params-card">
                    <h3>Configuration Parameters</h3>
                    <div class="config-param-row">
                        <div class="config-param-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect><line x1="8" y1="21" x2="16" y2="21"></line><line x1="12" y1="17" x2="12" y2="21"></line></svg>
                        </div>
                        <div class="config-param-value">Server: vless.example.com</div>
                    </div>
                    <div class="config-param-row">
                        <div class="config-param-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
                        </div>
                        <div class="config-param-value">Port: 443</div>
                    </div>
                    <div class="config-param-row">
                        <div class="config-param-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polygon points="12 6 8 12 12 18 16 12 12 6"></polygon></svg>
                        </div>
                        <div class="config-param-value">Encryption: none</div>
                    </div>
                    <div class="config-param-row">
                        <div class="config-param-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
                        </div>
                        <div class="config-param-value">UUID: <span class="uuid-display">{{.UUID}}</span></div>
                    </div>
                    <div class="config-param-row">
                        <div class="config-param-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect><line x1="8" y1="21" x2="16" y2="21"></line><line x1="12" y1="17" x2="12" y2="21"></line></svg>
                        </div>
                        <div class="config-param-value">SNI: vless.example.com</div>
                    </div>
                    <div class="config-param-row">
                        <div class="config-param-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="3" y1="9" x2="21" y2="9"></line><line x1="9" y1="21" x2="9" y2="9"></line></svg>
                        </div>
                        <div class="config-param-value">Network: WebSocket</div>
                    </div>
                    <div class="config-param-row">
                        <div class="config-param-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2s8 6 8 10c0 5-8 10-8 10-8 0-8-5-8-10 0-4 8-10 8-10z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                        </div>
                        <div class="config-param-value">Path: /websocket</div>
                    </div>
                    <div class="config-param-row">
                        <div class="config-param-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg>
                        </div>
                        <div class="config-param-value">Security: TLS</div>
                    </div>
                    <div class="config-param-row">
                        <div class="config-param-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2s8 6 8 10c0 5-8 10-8 10-8 0-8-5-8-10 0-4 8-10 8-10z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                        </div>
                        <div class="config-param-value">Fingerprint: chrome</div>
                    </div>
                </div>

                <!-- Security Tips -->
                <div class="security-tips tips-card">
                    <h3>Security Tips</h3>
                    <div class="security-tips-content">
                        <div class="security-tip-item">
                            <div class="security-tip-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg>
                            </div>
                            <div>
                                <p><strong>Keep your configuration secure:</strong> Don't share your UUID and configuration details with untrusted parties.</p>
                            </div>
                        </div>
                        <div class="security-tip-item">
                            <div class="security-tip-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
                            </div>
                            <div>
                                <p><strong>Regular updates:</strong> Keep your VPN client updated for the latest security patches and improvements.</p>
                            </div>
                        </div>
                        <div class="security-tip-item">
                            <div class="security-tip-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
                            </div>
                            <div>
                                <p><strong>Firewall protection:</strong> Enable and properly configure a firewall to enhance your VPN connection security.</p>
                            </div>
                        </div>
                        <div class="security-tip-item">
                            <div class="security-tip-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path><path d="M12 8v4"></path><path d="M12 16h.01"></path></svg>
                            </div>
                            <div>
                                <p><strong>Avoid phishing:</strong> Be cautious of phishing attempts and only use the official configuration details provided here.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function copyVlessUrl() {
            const vlessUrl = document.getElementById('vlessUrl').textContent;
            navigator.clipboard.writeText(vlessUrl).then(() => {
                const button = event.target;
                const originalText = button.textContent;
                button.textContent = '{{.Texts.copied}}';
                button.classList.add('success-animation');

                setTimeout(() => {
                    button.textContent = originalText;
                    button.classList.remove('success-animation');
                }, 2000);
            });
        }

        // Tab functionality
        document.querySelectorAll('.tab-button').forEach(button => {
            button.addEventListener('click', () => {
                const tabId = button.getAttribute('data-tab');

                // Hide all tabs and remove active class
                document.querySelectorAll('.tab-content').forEach(tab => {
                    tab.classList.remove('active');
                });
                document.querySelectorAll('.tab-button').forEach(btn => {
                    btn.classList.remove('active');
                });

                // Show selected tab and add active class to button
                document.getElementById(tabId).classList.add('active');
                button.classList.add('active');
            });
        });

        // Language selector functionality
        const languageToggle = document.getElementById('languageToggle');
        const languageDropdown = document.getElementById('languageDropdown');

        // Toggle dropdown on button click
        languageToggle.addEventListener('click', (event) => {
            event.stopPropagation();
            const expanded = languageToggle.getAttribute('aria-expanded') === 'true';
            languageToggle.setAttribute('aria-expanded', !expanded);
            languageDropdown.setAttribute('aria-hidden', expanded);
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', (event) => {
            const isClickInside = languageToggle.contains(event.target) || languageDropdown.contains(event.target);
            if (!isClickInside) {
                languageToggle.setAttribute('aria-expanded', 'false');
                languageDropdown.setAttribute('aria-hidden', 'true');
            }
        });

        // Change language on dropdown item click
        document.querySelectorAll('.language-dropdown a').forEach(item => {
            item.addEventListener('click', (event) => {
                event.preventDefault();
                const lang = item.getAttribute('data-lang');
                const currentUrl = new URL(window.location);
                currentUrl.searchParams.set('lang', lang);
                window.location.href = currentUrl.toString();
            });
        });

        // Add keyboard navigation for dropdown
        languageToggle.addEventListener('keydown', (event) => {
            if (event.key === 'Enter' || event.key === ' ') {
                event.preventDefault();
                languageToggle.click();
            } else if (event.key === 'Escape') {
                languageToggle.setAttribute('aria-expanded', 'false');
                languageDropdown.setAttribute('aria-hidden', 'true');
            }
        });

        // Add keyboard navigation for dropdown items
        const languageItems = document.querySelectorAll('.language-dropdown a');
        languageItems.forEach((item, index) => {
            item.addEventListener('keydown', (event) => {
                if (event.key === 'Enter' || event.key === ' ') {
                    event.preventDefault();
                    item.click();
                } else if (event.key === 'ArrowDown') {
                    event.preventDefault();
                    const nextIndex = (index + 1) % languageItems.length;
                    languageItems[nextIndex].focus();
                } else if (event.key === 'ArrowUp') {
                    event.preventDefault();
                    const prevIndex = (index - 1 + languageItems.length) % languageItems.length;
                    languageItems[prevIndex].focus();
                } else if (event.key === 'Escape') {
                    languageToggle.setAttribute('aria-expanded', 'false');
                    languageDropdown.setAttribute('aria-hidden', 'true');
                    languageToggle.focus();
                }
            });
        });
    </script>
</body>
</html>
